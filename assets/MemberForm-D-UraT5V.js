import{t as M,d as h,Q as _,j as e,a as P,V,c as x,h as t,S as R,e as k}from"./index-VQSAZRLI.js";import{a as A,F as E,u as L,I as S}from"./InputControllers-DDt3EF8g.js";import{g as y}from"./getFormValues-CGQBIzk4.js";import{u as v}from"./useRequestErrorInputResponse-IA9b4GC1.js";import{u as z}from"./useSuccessMessage-CrTeqooW.js";import{n as B}from"./inputsJoiSchema-DR80cPXO.js";import{F as w}from"./FormContainer-DscY9_xB.js";import{F as b}from"./forms-iRkAx9I5.js";import{A as D,a as O,L as $}from"./InputWrappers-BNYY81Vx.js";import{R as N}from"./RequiredBadge-BPkPqPAE.js";import{P as Q}from"./PostalCodeInputController-CQrCWMfS.js";import{B as U}from"./BpCheckbox-DAGCBt5E.js";function W(o,s,r){const l=z(),m=v(),[,i]=M(),u=h.useMemo(()=>o?y(s,o):y(s),[o,s]),p=h.useCallback((a,f)=>{(async()=>{try{(await r(a).unwrap()).id&&(o?l(_.PROFILE_UPDATE.successMsg):i(a))}catch(c){m(c,f)}})()},[m,r,o,i,l]);return{initialFormValues:u,handleProfileInfo:p}}const{terms_conditions:d}=b,F=h.memo(function({control:s}){const{field:r}=A({control:s,name:d.name,defaultValue:!1});return e.jsx(E,{sx:{m:0,mx:"auto"},control:e.jsx(U,{...r,inputProps:{"aria-label":d.label}}),label:e.jsxs(e.Fragment,{children:[e.jsx(P,{component:V,textTransform:"none",fontSize:"fontSize",sx:{textDecoration:"none"},to:`/${x.accounts.path}/${x.terms_and_condition.path}`,className:"link",children:d.label.split(" ")[0]}),e.jsxs(P,{variant:"span",children:[" ",d.label.split(" ")[1]]})]}),inputRef:r.ref,componentsProps:{typography:{fontSize:"fontSize"}}})}),G=F;F.propTypes={control:t.object.isRequired};function H({userSpecific:o,form:s,formSchema:r,query:l,isLoading:m}){const{initialFormValues:i,handleProfileInfo:u}=W(o,s,l),{handleSubmit:p,control:a,formState:{isValid:f,isDirty:j},getValues:c,setValue:I,setError:g}=L({defaultValues:i,...o?{values:i}:{},resolver:B(r),mode:"onChange"}),T=o?x.account_settings_profile_info.page_title:"新規会員登録";return e.jsx(w,{title:T,titleAlign:o?"":"center",maxWidth:560,children:e.jsx("form",{onSubmit:p(n=>u(n,g)),children:e.jsxs(R,{spacing:3,children:[e.jsxs(R,{gap:2,width:"100%",children:[s.map(n=>{if(n.name===b.terms_conditions.name)return;const{label:q,...C}=n;return e.jsxs(D,{children:[e.jsxs(O,{children:[e.jsx($,{title:n.name,children:q}),e.jsx(N,{isRequired:n.required})]}),n.name!==b.postal_code.name?e.jsx(S,{...C,variant:"outlined",control:a,inputProps:{className:"disabled-text-placeholder"}}):e.jsx(Q,{restProps:C,control:a,getValues:c,setValue:I,setError:g})]},n.name)}),!o&&e.jsx(G,{control:a})]}),e.jsx(k,{disabled:!f||!j,loading:m,sx:{alignSelf:o?"flex-end":"center"},children:o?"会員情報を変更する":"会員登録する"})]})})})}H.propTypes={userSpecific:t.oneOfType([t.object,t.bool]),form:t.array.isRequired,formSchema:t.object.isRequired,query:t.func.isRequired,isLoading:t.bool.isRequired};export{H as M};
