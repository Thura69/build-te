import{u as E,N as L,d as f,Q as j,a9 as O,a5 as R,a8 as k,j as e,c as A,S as h,e as F,h as b,aa as P,ab as v}from"./index-VQSAZRLI.js";import{B as w}from"./BreadcrumbsDynamic-Cdp7sj4a.js";import{u as U,I as V}from"./InputControllers-DDt3EF8g.js";import{F as B}from"./FormContainer-DscY9_xB.js";import{f as y,g as M}from"./forms-iRkAx9I5.js";import{L as q}from"./InputWrappers-BNYY81Vx.js";import{R as z}from"./RelatedInputs-qkQvT4Uy.js";import{a as G,b as H}from"./notificationDistributionSlice-fMEmnyFC.js";import{u as Q}from"./useConfirmationGuard-BdDljXp2.js";import{u as W}from"./useRequestErrorInputResponse-IA9b4GC1.js";import{g as J}from"./getFormValues-CGQBIzk4.js";import{u as K}from"./useSuccessMessage-CrTeqooW.js";import{u as X}from"./useCurrentPages-Itpqw3L7.js";import{F as Y}from"./TextField-D3R9oRAX.js";import"./useThemeProps-DmHRh9Bz.js";import"./index-BYV2JyI0.js";import"./NumericFormatCustom-Bp_K41t6.js";import"./react-number-format.es-DoWa0wzu.js";function Z(o){const{relativePaths:r}=X(),n=E(),s=L(),{openModal:i}=Q(),[a,{isLoading:p}]=G(),l=K(),c=W(),m=f.useMemo(()=>J(M,y,o||null),[o]),g=f.useCallback(()=>{i("",j.NOTIFICATION_ADD.operation_name)},[i]),t=f.useCallback((u,N)=>{(async()=>{const{delivery_settings:T,deliver_reservation:C}=u;let I;if(T==="RESERVATION"&&C.date){const d=new Date(u.deliver_reservation.date);if(C.time){const S=new Date(C.time);d.setUTCHours(S.getUTCHours(),S.getUTCMinutes(),S.getUTCSeconds())}I=d.toISOString()}const _={...u,deliver_reservation:I};try{(await a(_).unwrap()).id&&(l(j.NOTIFICATION_ADD.successMsg),n(r.at(-2),{replace:!0}))}catch(d){c(d,N)}finally{s(O(!1))}})()},[a,s,n,r,l,c]),x=f.useMemo(()=>p,[p]);return{initialFormValues:m,handleSubmitForm:g,handleInvite:t,isLoading:x}}function D({userSpecific:o}){const{initialFormValues:r,handleSubmitForm:n,handleInvite:s,isLoading:i}=Z(o),a=R(k),{handleSubmit:p,control:l,getValues:c,setValue:m,setError:g}=U({defaultValues:r});return f.useEffect(()=>{const t=c().deliver_reservation.time;t&&console.log(t.toISOString()),a&&s(c(),g)},[a,s,c,g]),e.jsx(B,{title:A.notification_distribution.page_title,maxWidth:960,children:e.jsx("form",{onSubmit:p(n),children:e.jsxs(h,{direction:"column",spacing:5,mb:5,children:[e.jsx(h,{gap:3,width:"100%",children:M.map(t=>{const{label:x,...u}=t;return e.jsxs(h,{spacing:3,children:[e.jsxs(Y,{children:[e.jsx(q,{mb:.5,title:t.name,...t.type==="radio"?{fontWeight:700,fontSize:"h5.fontSize",mb:2.5,mt:1}:{},children:x}),e.jsx(V,{...u,variant:"outlined",control:l})]}),t.type==="radio"&&e.jsx(z,{name:t.name,options:t.options,control:l,relatedInputMap:y,setValue:m})]},t.name)})}),e.jsxs(h,{direction:"row",spacing:2.25,alignSelf:"flex-end",children:[e.jsx(F,{loading:i,variant:"outlined",onClick:()=>m("draft",!0),children:"下書きに保存する"}),e.jsx(F,{loading:i,onClick:()=>m("draft",!1),children:"配信する"})]})]})})})}D.propTypes={userSpecific:b.oneOfType([b.object,b.bool])};function Ce(){const{id:o}=P(),{data:r,isLoading:n,isSuccess:s,isError:i,error:a}=H({id:o},{skip:!o});return n?e.jsx(v,{children:"Loading..."}):!s&&i?e.jsx(v,{children:a.data.detail||"Not found."}):(console.log(r),e.jsxs(e.Fragment,{children:[e.jsx(w,{userSpecific:""}),e.jsx(D,{userSpecific:!1})]}))}export{Ce as default};
